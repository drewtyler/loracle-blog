{{- define "main" }}

{{- $pages := where site.RegularPages "Type" "in" site.Params.mainSections }}
{{- $featured := first 1 $pages }}
{{- $rest := after 1 $pages }}

<div class="home-layout">
    <main class="home-main">
        {{/* Featured / Latest Post */}}
        {{- range $featured }}
        <article class="featured-post">
            <span class="featured-label">Latest</span>
            <h1 class="featured-title">
                <a href="{{ .Permalink }}">{{- .Title }}</a>
            </h1>
            <div class="featured-meta">
                {{- partial "post_meta.html" . -}}
            </div>
            <div class="featured-content">
                {{ .Summary }}
            </div>
            <a href="{{ .Permalink }}" class="read-more">Continue reading â†’</a>
        </article>
        {{- end }}

        {{/* Other posts */}}
        <div class="other-posts">
            <h2 class="section-title">Archive</h2>
            {{- range $rest }}
            <article class="post-card">
                <h3><a href="{{ .Permalink }}">{{- .Title }}</a></h3>
                <p>{{ .Summary | truncate 140 }}</p>
                <span class="post-date">{{ .Date.Format "Jan 2, 2006" }}</span>
            </article>
            {{- end }}
        </div>
    </main>

    <aside class="home-sidebar">
        <div class="sidebar-about">
            <h2>Loracle Blog</h2>
            <p class="tagline">Thoughts on D&D, memory, and storytelling.</p>
            <p class="product-desc"><strong>Loracle</strong> records your sessions and builds a searchable knowledge base automatically. No more forgotten NPCs or lost plot threads.</p>
        </div>
    </aside>
</div>

{{- end }}{{- /* end main */ -}}
